<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>adapt-authoring-api/lib/AbstractApiModule.js - Adapt authoring tool UI documentation</title>
    
    <meta name="description" content="Adapt authoring tool UI documentation" />
    
        <meta name="keywords" content="v1.0.0-rc.2" />
        <meta name="keyword" content="v1.0.0-rc.2" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h2><a class="menu-title" ><img class="logo" src="assets/logo-colour.png" />Adapt authoring tool back-end API documentation<br><span class="version">v1.0.0-rc.2</span></a></h2><h2><a href="index.html" target="_self" class="menu-item" id="home_link" >Home</a></h2><h2><a href="https://www.adaptlearning.org/" target="_blank" class="menu-item" id="website_link" >Project Website</a></h2><h2><a href="https://community.adaptlearning.org/mod/forum/view.php?id=4" target="_blank" class="menu-item" id="forum_link" >Technical Discussion Forum</a></h2><h3>Classes</h3><ul><li><a href="AbstractApiModule.html">AbstractApiModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="AbstractApiModule.html#validateValues">validateValues</a></li></ul></li><li><a href="AbstractApiUtils.html">AbstractApiUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AbstractApiUtils.html#.argsFromReq">argsFromReq</a></li><li data-type='method' style='display: none;'><a href="AbstractApiUtils.html#.httpMethodToAction">httpMethodToAction</a></li><li data-type='method' style='display: none;'><a href="AbstractApiUtils.html#.httpMethodToDBFunction">httpMethodToDBFunction</a></li></ul></li><li><a href="AbstractAsset.html">AbstractAsset</a><ul class='members'><li data-type='member' style='display: none;'><a href="AbstractAsset.html#.name">name</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#assetRoot">assetRoot</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#ffmpeg">ffmpeg</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#ffprobe">ffprobe</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#hasThumb">hasThumb</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#isAudio">isAudio</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#isImage">isImage</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#isVideo">isVideo</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#path">path</a></li><li data-type='member' style='display: none;'><a href="AbstractAsset.html#thumb">thumb</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="AbstractAsset.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#ensureExists">ensureExists</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#generateThumb">generateThumb</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#move">move</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#read">read</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#resolvePath">resolvePath</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#updateFile">updateFile</a></li><li data-type='method' style='display: none;'><a href="AbstractAsset.html#write">write</a></li></ul></li><li><a href="AbstractAuthModule.html">AbstractAuthModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#authenticate">authenticate</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#authenticateHandler">authenticateHandler</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#disavowUser">disavowUser</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#enableHandler">enableHandler</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#register">register</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#registerHandler">registerHandler</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#secureRoute">secureRoute</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#setUserEnabled">setUserEnabled</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="AbstractAuthModule.html#unsecureRoute">unsecureRoute</a></li></ul></li><li><a href="AbstractModule.html">AbstractModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AbstractModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AbstractModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AbstractModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AbstractModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AbstractModule.html#setReady">setReady</a></li></ul></li><li><a href="AdaptError.html">AdaptError</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdaptError.html#setData">setData</a></li><li data-type='method' style='display: none;'><a href="AdaptError.html#toString">toString</a></li></ul></li><li><a href="AdaptFrameworkBuild.html">AdaptFrameworkBuild</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#.getBuildExpiry">getBuildExpiry</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#.run">run</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#build">build</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#cachePluginData">cachePluginData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#copyAssets">copyAssets</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#copySource">copySource</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#createIdMap">createIdMap</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#createPreview">createPreview</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#createZip">createZip</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#loadAssetData">loadAssetData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#loadCourseData">loadCourseData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#recordBuildAttempt">recordBuildAttempt</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#removeOldBuilds">removeOldBuilds</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#sortContentItems">sortContentItems</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#transformContentItems">transformContentItems</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkBuild.html#writeContentJson">writeContentJson</a></li></ul></li><li><a href="AdaptFrameworkBuildOptions.html">AdaptFrameworkBuildOptions</a></li><li><a href="AdaptFrameworkImport.html">AdaptFrameworkImport</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#.run">run</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#.typeToSchema">typeToSchema</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#applyDefaults">applyDefaults</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#cleanUp">cleanUp</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#convertSchemas">convertSchemas</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#extractAssetsRecursive">extractAssetsRecursive</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#getSortedData">getSortedData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#import">import</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#importContentObject">importContentObject</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#importCourseAssets">importCourseAssets</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#importCourseData">importCourseData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#importCoursePlugins">importCoursePlugins</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#loadContentFile">loadContentFile</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#loadCourseData">loadCourseData</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#prepare">prepare</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkImport.html#transformData">transformData</a></li></ul></li><li><a href="AdaptFrameworkImportOptions.html">AdaptFrameworkImportOptions</a></li><li><a href="AdaptFrameworkModule.html">AdaptFrameworkModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#buildCourse">buildCourse</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#checkContentAccess">checkContentAccess</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#getPluginPath">getPluginPath</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#importCourse">importCourse</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#initRoutes">initRoutes</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#installFramework">installFramework</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#loadSchemas">loadSchemas</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkModule.html#setReady">setReady</a></li></ul></li><li><a href="AdaptFrameworkUtils.html">AdaptFrameworkUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.getHandler">getHandler</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.handleImportFile">handleImportFile</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.importHandler">importHandler</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.inferBuildAction">inferBuildAction</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.postHandler">postHandler</a></li><li data-type='method' style='display: none;'><a href="AdaptFrameworkUtils.html#.retrieveBuildData">retrieveBuildData</a></li></ul></li><li><a href="App.html">App</a><ul class='members'><li data-type='member' style='display: none;'><a href="App.html#.instance">instance</a></li><li data-type='member' style='display: none;'><a href="App.html#app">app</a></li><li data-type='member' style='display: none;'><a href="App.html#args">args</a></li><li data-type='member' style='display: none;'><a href="App.html#dependencies">dependencies</a></li><li data-type='member' style='display: none;'><a href="App.html#dependencyloader">dependencyloader</a></li><li data-type='member' style='display: none;'><a href="App.html#initTime">initTime</a></li><li data-type='member' style='display: none;'><a href="App.html#name">name</a></li><li data-type='member' style='display: none;'><a href="App.html#pkg">pkg</a></li><li data-type='member' style='display: none;'><a href="App.html#readyHook">readyHook</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="App.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="App.html#init">init</a></li><li data-type='method' style='display: none;'><a href="App.html#log">log</a></li><li data-type='method' style='display: none;'><a href="App.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="App.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="App.html#start">start</a></li><li data-type='method' style='display: none;'><a href="App.html#waitForModule">waitForModule</a></li></ul></li><li><a href="Assetsmodule.html">Assetsmodule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Assetsmodule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#createFsWrapper">createFsWrapper</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#onRequest">onRequest</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#performHousekeeping">performHousekeeping</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#registerAssetType">registerAssetType</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#serveAssetHandler">serveAssetHandler</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="Assetsmodule.html#validateValues">validateValues</a></li></ul></li><li><a href="Authentication.html">Authentication</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Authentication.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#checkHandler">checkHandler</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#disavowHandler">disavowHandler</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#disavowUser">disavowUser</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#generateTokenHandler">generateTokenHandler</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#init">init</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#registerPlugin">registerPlugin</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#registerUser">registerUser</a></li><li data-type='method' style='display: none;'><a href="Authentication.html#retrieveTokensHandler">retrieveTokensHandler</a></li></ul></li><li><a href="AuthModule.html">AuthModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AuthModule.html#apiMiddleware">apiMiddleware</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#initAuthData">initAuthData</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#rootMiddleware">rootMiddleware</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#secureRoute">secureRoute</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="AuthModule.html#unsecureRoute">unsecureRoute</a></li></ul></li><li><a href="AuthoredModule.html">AuthoredModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AuthoredModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#registerModule">registerModule</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#updateAuthor">updateAuthor</a></li><li data-type='method' style='display: none;'><a href="AuthoredModule.html#updateTimestamps">updateTimestamps</a></li></ul></li><li><a href="AuthToken.html">AuthToken</a><ul class='members'><li data-type='member' style='display: none;'><a href="AuthToken.html#.secret">secret</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="AuthToken.html#.decode">decode</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.find">find</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.generate">generate</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.getScopesForRole">getScopesForRole</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.getScopesForUser">getScopesForUser</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.hasExpired">hasExpired</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.initRequestData">initRequestData</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.isSuper">isSuper</a></li><li data-type='method' style='display: none;'><a href="AuthToken.html#.revoke">revoke</a></li></ul></li><li><a href="AuthUtils.html">AuthUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="AuthUtils.html#.createEmptyStore">createEmptyStore</a></li><li data-type='method' style='display: none;'><a href="AuthUtils.html#.getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="AuthUtils.html#.initAuthData">initAuthData</a></li><li data-type='method' style='display: none;'><a href="AuthUtils.html#.log">log</a></li></ul></li><li><a href="BrowserslistModule.html">BrowserslistModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="BrowserslistModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="BrowserslistModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="BrowserslistModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="BrowserslistModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="BrowserslistModule.html#setReady">setReady</a></li></ul></li><li><a href="ConfigModule.html">ConfigModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ConfigModule.html#envVarToConfigKey">envVarToConfigKey</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#get">get</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#getPublicConfig">getPublicConfig</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#has">has</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#initRouter">initRouter</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#processModuleSchema">processModuleSchema</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#set">set</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#storeEnvSettings">storeEnvSettings</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#storeSchemaSettings">storeSchemaSettings</a></li><li data-type='method' style='display: none;'><a href="ConfigModule.html#storeUserSettings">storeUserSettings</a></li></ul></li><li><a href="ContentModule.html">ContentModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ContentModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#clone">clone</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#cloneCourse">cloneCourse</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#deleteChildren">deleteChildren</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getContentSchemaName">getContentSchemaName</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getCourseIdFromParams">getCourseIdFromParams</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getPluginSchemas">getPluginSchemas</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#getUsedComponentNames">getUsedComponentNames</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#handleClone">handleClone</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#handleCreateCourse">handleCreateCourse</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#schemaNameMiddleware">schemaNameMiddleware</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#updateEnabledPlugins">updateEnabledPlugins</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#updateSortOrder">updateSortOrder</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="ContentModule.html#validateValues">validateValues</a></li></ul></li><li><a href="ContentPluginModule.html">ContentPluginModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#getPluginExtensionSchemas">getPluginExtensionSchemas</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#getPluginUses">getPluginUses</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#initPlugins">initPlugins</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#insertOrUpdate">insertOrUpdate</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#installHandler">installHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#installPlugins">installPlugins</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#processPluginSchemas">processPluginSchemas</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#uninstallHandler">uninstallHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#uninstallPlugin">uninstallPlugin</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#updateHandler">updateHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#updatePlugin">updatePlugin</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#usesHandler">usesHandler</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="ContentPluginModule.html#validateValues">validateValues</a></li></ul></li><li><a href="CourseAssetsModule.html">CourseAssetsModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#extractAssetIds">extractAssetIds</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#handleContentEvent">handleContentEvent</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="CourseAssetsModule.html#validateValues">validateValues</a></li></ul></li><li><a href="CourseThemeModule.html">CourseThemeModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#applyHandler">applyHandler</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#getVariablesString">getVariablesString</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#removeHandler">removeHandler</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#validateValues">validateValues</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#writeCustomLess">writeCustomLess</a></li><li data-type='method' style='display: none;'><a href="CourseThemeModule.html#writeFile">writeFile</a></li></ul></li><li><a href="DataCache.html">DataCache</a></li><li><a href="DefaultPluginsModule.html">DefaultPluginsModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DefaultPluginsModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="DefaultPluginsModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="DefaultPluginsModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="DefaultPluginsModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="DefaultPluginsModule.html#setReady">setReady</a></li></ul></li><li><a href="DependencyLoader.html">DependencyLoader</a><ul class='methods'><li data-type='method' style='display: none;'><a href="DependencyLoader.html#load">load</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#loadConfigs">loadConfigs</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#loadModule">loadModule</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#loadModuleConfig">loadModuleConfig</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#loadModules">loadModules</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#logError">logError</a></li><li data-type='method' style='display: none;'><a href="DependencyLoader.html#waitForModule">waitForModule</a></li></ul></li><li><a href="ErrorModule.html">ErrorModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ErrorModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ErrorModule.html#loadErrors">loadErrors</a></li></ul></li><li><a href="Hook.html">Hook</a><ul class='members'><li data-type='member' style='display: none;'><a href="Hook.html#.Types">Types</a></li><li data-type='member' style='display: none;'><a href="Hook.html#hasObservers">hasObservers</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Hook.html#invoke">invoke</a></li><li data-type='method' style='display: none;'><a href="Hook.html#onInvoke">onInvoke</a></li><li data-type='method' style='display: none;'><a href="Hook.html#tap">tap</a></li><li data-type='method' style='display: none;'><a href="Hook.html#untap">untap</a></li></ul></li><li><a href="JsonSchemaModule.html">JsonSchemaModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#addKeyword">addKeyword</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#applyDefaults">applyDefaults</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#applyPatch">applyPatch</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#checkFormats">checkFormats</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#extendSchema">extendSchema</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#initFormats">initFormats</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#loadSchema">loadSchema</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#loadSchemaExtensions">loadSchemaExtensions</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#loadSchemaHierarchy">loadSchemaHierarchy</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#registerSchema">registerSchema</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#registerSchemas">registerSchemas</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="JsonSchemaModule.html#validate">validate</a></li></ul></li><li><a href="LangModule.html">LangModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LangModule.html#addTranslationUtils">addTranslationUtils</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#getPhrasesForLang">getPhrasesForLang</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#loadPhrases">loadPhrases</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#loadPhrasesForDir">loadPhrasesForDir</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#loadRoutes">loadRoutes</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#t">t</a></li><li data-type='method' style='display: none;'><a href="LangModule.html#translate">translate</a></li></ul></li><li><a href="LocalAsset.html">LocalAsset</a><ul class='members'><li data-type='member' style='display: none;'><a href="LocalAsset.html#.name">name</a></li><li data-type='member' style='display: none;'><a href="LocalAsset.html#assetRoot">assetRoot</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="LocalAsset.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#ensureDir">ensureDir</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#ensureExists">ensureExists</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#generateMetadata">generateMetadata</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#move">move</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#read">read</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#resolvePath">resolvePath</a></li><li data-type='method' style='display: none;'><a href="LocalAsset.html#write">write</a></li></ul></li><li><a href="LocalAuthModule.html">LocalAuthModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#.formatRemainingTime">formatRemainingTime</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#applyLocking">applyLocking</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#authenticate">authenticate</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#authenticateHandler">authenticateHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#changePasswordHandler">changePasswordHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#createPasswordReset">createPasswordReset</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#disavowUser">disavowUser</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#enableHandler">enableHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#forgotPasswordHandler">forgotPasswordHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#handleLockStatus">handleLockStatus</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#inviteHandler">inviteHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#register">register</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#registerHandler">registerHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#registerSuperHandler">registerSuperHandler</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#secureRoute">secureRoute</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#setUserEnabled">setUserEnabled</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#unsecureRoute">unsecureRoute</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#updateUser">updateUser</a></li><li data-type='method' style='display: none;'><a href="LocalAuthModule.html#validatePasswordHandler">validatePasswordHandler</a></li></ul></li><li><a href="LoggerModule.html">LoggerModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="LoggerModule.html#.colourise">colourise</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#.getDateStamp">getDateStamp</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#getModuleOverrides">getModuleOverrides</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#isLevelEnabled">isLevelEnabled</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#isLoggingEnabled">isLoggingEnabled</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="LoggerModule.html#setReady">setReady</a></li></ul></li><li><a href="MailerModule.html">MailerModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MailerModule.html#createTransporter">createTransporter</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#isValidEmail">isValidEmail</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#isValidSmtpConnectionUrl">isValidSmtpConnectionUrl</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#readConfig">readConfig</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#send">send</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#testConnection">testConnection</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#testEmailHandler">testEmailHandler</a></li><li data-type='method' style='display: none;'><a href="MailerModule.html#validateConfig">validateConfig</a></li></ul></li><li><a href="MiddlewareModule.html">MiddlewareModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#bodyParserJson">bodyParserJson</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#bodyParserUrlEncoded">bodyParserUrlEncoded</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#fileUploadParser">fileUploadParser</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#setDefaultFileOptions">setDefaultFileOptions</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="MiddlewareModule.html#urlUploadParser">urlUploadParser</a></li></ul></li><li><a href="module.exports.html">exports</a><ul class='methods'><li data-type='method' style='display: none;'><a href="module.exports.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#init">init</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#log">log</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="module.exports.html#setReady">setReady</a></li></ul></li><li></li><li></li><li><a href="MongoDBLoggerModule.html">MongoDBLoggerModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#logToDb">logToDb</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="MongoDBLoggerModule.html#validateValues">validateValues</a></li></ul></li><li><a href="MongoDBModule.html">MongoDBModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="MongoDBModule.html#connect">connect</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#getCollection">getCollection</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#getError">getError</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#getStats">getStats</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#parseOptions">parseOptions</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#replace">replace</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#setIndex">setIndex</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="MongoDBModule.html#update">update</a></li></ul></li><li><a href="ObjectIdUtils.html">ObjectIdUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ObjectIdUtils.html#.addSchemaKeyword">addSchemaKeyword</a></li><li data-type='method' style='display: none;'><a href="ObjectIdUtils.html#.create">create</a></li><li data-type='method' style='display: none;'><a href="ObjectIdUtils.html#.isValid">isValid</a></li><li data-type='method' style='display: none;'><a href="ObjectIdUtils.html#.parse">parse</a></li><li data-type='method' style='display: none;'><a href="ObjectIdUtils.html#.parseIds">parseIds</a></li></ul></li><li><a href="PasswordUtils.html">PasswordUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.compare">compare</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.createReset">createReset</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.deleteReset">deleteReset</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.generate">generate</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.getRandomHex">getRandomHex</a></li><li data-type='method' style='display: none;'><a href="PasswordUtils.html#.validateReset">validateReset</a></li></ul></li><li><a href="Permissions.html">Permissions</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Permissions.html#.init">init</a></li><li data-type='method' style='display: none;'><a href="Permissions.html#check">check</a></li><li data-type='method' style='display: none;'><a href="Permissions.html#checkRoutes">checkRoutes</a></li><li data-type='method' style='display: none;'><a href="Permissions.html#getScopesForRoute">getScopesForRoute</a></li><li data-type='method' style='display: none;'><a href="Permissions.html#secureRoute">secureRoute</a></li></ul></li><li><a href="RolesModule.html">RolesModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="RolesModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#initConfigRoles">initConfigRoles</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#initDefaultRoles">initDefaultRoles</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#onUpdateRoles">onUpdateRoles</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#shortNamesToIds">shortNamesToIds</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="RolesModule.html#validateValues">validateValues</a></li></ul></li><li><a href="Router.html">Router</a><ul class='methods'><li data-type='method' style='display: none;'><a href="Router.html#addHandlerMiddleware">addHandlerMiddleware</a></li><li data-type='method' style='display: none;'><a href="Router.html#addMiddleware">addMiddleware</a></li><li data-type='method' style='display: none;'><a href="Router.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="Router.html#createChildRouter">createChildRouter</a></li><li data-type='method' style='display: none;'><a href="Router.html#flattenRouters">flattenRouters</a></li><li data-type='method' style='display: none;'><a href="Router.html#getHandlerMiddleware">getHandlerMiddleware</a></li><li data-type='method' style='display: none;'><a href="Router.html#init">init</a></li><li data-type='method' style='display: none;'><a href="Router.html#log">log</a></li><li data-type='method' style='display: none;'><a href="Router.html#validateRoute">validateRoute</a></li><li data-type='method' style='display: none;'><a href="Router.html#warnOnInited">warnOnInited</a></li></ul></li><li><a href="ServerModule.html">ServerModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ServerModule.html#close">close</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#listen">listen</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#start">start</a></li><li data-type='method' style='display: none;'><a href="ServerModule.html#static">static</a></li></ul></li><li><a href="ServerUtils.html">ServerUtils</a><ul class='methods'><li data-type='method' style='display: none;'><a href="ServerUtils.html#.addErrorHandler">addErrorHandler</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.addExistenceProps">addExistenceProps</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.apiNotFoundHandler">apiNotFoundHandler</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.cacheRouteConfig">cacheRouteConfig</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.debugRequestTime">debugRequestTime</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.generateRouterMap">generateRouterMap</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.genericErrorHandler">genericErrorHandler</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.handleInternalRoutes">handleInternalRoutes</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.mapHandler">mapHandler</a></li><li data-type='method' style='display: none;'><a href="ServerUtils.html#.rootNotFoundHandler">rootNotFoundHandler</a></li></ul></li><li><a href="SessionsModule.html">SessionsModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SessionsModule.html#clearSession">clearSession</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="SessionsModule.html#storeAuthHeader">storeAuthHeader</a></li></ul></li><li><a href="SpoorTrackingModule.html">SpoorTrackingModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#initRoutes">initRoutes</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#insertTrackingId">insertTrackingId</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#resetTrackingIds">resetTrackingIds</a></li><li data-type='method' style='display: none;'><a href="SpoorTrackingModule.html#setReady">setReady</a></li></ul></li><li><a href="TagsModule.html">TagsModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="TagsModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#autocompleteHandler">autocompleteHandler</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#registerModule">registerModule</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="TagsModule.html#validateValues">validateValues</a></li></ul></li><li><a href="UiModule.html">UiModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UiModule.html#addUiPlugin">addUiPlugin</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#build">build</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#servePage">servePage</a></li><li data-type='method' style='display: none;'><a href="UiModule.html#setReady">setReady</a></li></ul></li><li><a href="UsersModule.html">UsersModule</a><ul class='methods'><li data-type='method' style='display: none;'><a href="UsersModule.html#addRoute">addRoute</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#addRoutes">addRoutes</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#checkAccess">checkAccess</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#delete">delete</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#deleteMany">deleteMany</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#find">find</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#getConfig">getConfig</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#getSchema">getSchema</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#handleValidation">handleValidation</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#init">init</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#insert">insert</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#log">log</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#mapStatusCode">mapStatusCode</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#onReady">onReady</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#onRequest">onRequest</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#parseQuery">parseQuery</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#processRequestMiddleware">processRequestMiddleware</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#queryHandler">queryHandler</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#requestHandler">requestHandler</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#sanitise">sanitise</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#sanitiseItem">sanitiseItem</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#sanitiseRequestDataMiddleware">sanitiseRequestDataMiddleware</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#schemaNameMiddleware">schemaNameMiddleware</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#serveSchema">serveSchema</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#setDefaultOptions">setDefaultOptions</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#setReady">setReady</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#setUpPagination">setUpPagination</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#setValues">setValues</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#update">update</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#updateAccess">updateAccess</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#useDefaultRouteConfig">useDefaultRouteConfig</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#validate">validate</a></li><li data-type='method' style='display: none;'><a href="UsersModule.html#validateValues">validateValues</a></li></ul></li><li><a href="Utils.html">Utils</a><ul class='members'><li data-type='member' style='display: none;'><a href="Utils.html#.metadataFileName">metadataFileName</a></li><li data-type='member' style='display: none;'><a href="Utils.html#.packageFileName">packageFileName</a></li></ul><ul class='methods'><li data-type='method' style='display: none;'><a href="Utils.html#.getArgs">getArgs</a></li><li data-type='method' style='display: none;'><a href="Utils.html#.isObject">isObject</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="express-external_App.html">App</a></li><li><a href="express-external_Request.html">Request</a></li><li><a href="express-external_Response.html">Response</a></li><li><a href="express-external_Router.html">Router</a></li><li><a href="external-http-Server.html">http-Server</a></li><li><a href="mongodb-external_Collection.html">Collection</a></li><li><a href="mongodb-external_MongoClient.html">MongoClient</a></li><li><a href="mongodb-external_ObjectId.html">ObjectId</a></li><li><a href="nodemailer-external_Transport.html">Transport</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ApiRequestData">ApiRequestData</a></li><li><a href="global.html#ApiRoute">ApiRoute</a></li><li><a href="global.html#AssetMetadata">AssetMetadata</a></li><li><a href="global.html#FileUploadOptions">FileUploadOptions</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#middleware">middleware</a></li><li><a href="global.html#Route">Route</a></li><li><a href="global.html#RouteStore">RouteStore</a></li><li><a href="global.html#schemasHandler">schemasHandler</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">adapt-authoring-api/lib/AbstractApiModule.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import _ from 'lodash';
import { AbstractModule, Hook } from 'adapt-authoring-core';
import ApiUtils from './AbstractApiUtils.js';
import DataCache from './DataCache.js';
/**
 * Abstract module for creating APIs
 * @extends {AbstractModule}
 */
class AbstractApiModule extends AbstractModule {
  /**
   * Returns the 'OK' status code to match the HTTP method
   * @param {String} httpMethod 
   * @return {Number} HTTP status code
   */
  mapStatusCode(httpMethod) {
    const map = {
      post: 201,
      get: 200,
      put: 200,
      patch: 200,
      delete: 204
    };
    return map[httpMethod];
  }
  /** @override */
  async init() {
    /**
     * Signifies that the module instance is an API module. Can be used by other modules for quick verification checks.
     * @type {Boolean}
     */
    this.isApiModule = true;
    /**
     * Data cache which can be used to reduce DB calls
     */
    this.cache = new DataCache({
      enable: this.getConfig('enableCache'),
      lifespan: this.getConfig('cacheLifespan')
    });
    /**
     * Hook invoked when a new API request is handled
     * @type {Hook}
     */
    this.requestHook = new Hook({ mutable: true });
    /**
     * Hook invoked before data is inserted into the database
     * @type {Hook}
     */
    this.preInsertHook = new Hook({ mutable: true });
    /**
     * Hook invoked after data is inserted into the database
     * @type {Hook}
     */
    this.postInsertHook = new Hook();
    /**
     * Hook invoked before data is updated in the database
     * @type {Hook}
     */
    this.preUpdateHook = new Hook({ mutable: true });
    /**
     * Hook invoked after data is updated in the database
     * @type {Hook}
     */
    this.postUpdateHook = new Hook();
    /**
     * Hook invoked before data is deleted
     * @type {Hook}
     */
    this.preDeleteHook = new Hook();
    /**
     * Hook invoked after data is deleted
     * @type {Hook}
     */
    this.postDeleteHook = new Hook();
    /**
     * Hook invoked by DB wrapper functions to check access to individual data items
     * @type {Hook}
     */
    this.accessCheckHook = new Hook();

    await this.setValues();
    this.validateValues();
    await this.addRoutes();
  }
  /**
   * Sets values used to initialise the API
   * @return {Promise}
   */
  async setValues() {
    /**
     * Name of the API module
     * @type {String}
     */
    this.root = undefined;
    /**
     * The Router instance used for HTTP requests
     * @type {Router}
     */
    this.router = undefined;
    /**
     * Routes to be added to the API router
     * @type {Array&lt;ApiRoute>}
     */
    this.routes = undefined;
    /**
     * The scope to be used  (see AbstractApiModule#useDefaultRouteConfig)
     * @type {String}
     */
    this.permissionsScope = undefined;
    /**
     * Default DB collection to store data to (can be overridden by individual handlers)
     * @type {String}
     */
    this.collectionName = undefined;
    /**
     * Default schema to use for validation (can be overridden by individual handlers)
     * @type {String}
     */
    this.schemaName = undefined;
  }
  /**
   * Takes an input options param and populates it with defaults
   * @param {Object} options
   */
  setDefaultOptions(options) {
    _.defaults(options, {
      schemaName: this.schemaName,
      collectionName: this.collectionName,
      validate: true,
      invokePostHook: true
    });
  }
  /**
   * Uses default configuration for API routes
   * @example
   * POST /
   * GET /:_id?
   * PUT/DELETE  /:_id
   */
  useDefaultRouteConfig() {
    if(!this.root) {
      return this.log('error', 'Must set API root before calling useDefaultConfig function');
    }
    const readPerms = [`read:${this.permissionsScope || this.root}`];
    const writePerms = [`write:${this.permissionsScope || this.root}`];
    const handler = this.requestHandler();
    /** @ignore */ this.routes = [
      {
        route: '/',
        modifiers: ['post'],
        handlers: { post: handler, get: this.queryHandler() },
        permissions: { post: writePerms, get: readPerms }
      },
      {
        route: '/schema',
        handlers: { get: this.serveSchema.bind(this) },
        permissions: { get: ['read:schema'] }
      },
      {
        route: '/:_id',
        modifiers: ['post', 'patch', 'delete'],
        handlers: { put: handler, get: handler, patch: handler, delete: handler },
        permissions: { put: writePerms, get: readPerms, patch: writePerms, delete: writePerms }
      },
      {
        route: '/query',
        validate: false,
        handlers: { post: this.queryHandler() },
        permissions: { post: readPerms }
      }
    ];
  }
  /**
   * Checks required values have been set
   */
  validateValues() {
    if(!this.root &amp;&amp; !this.router) {
      throw this.app.errors.NO_ROOT_OR_ROUTER_DEF;
    }
    if(!this.routes) {
      throw this.app.errors.NO_ROUTES_DEF;
    }
    if(!this.collectionName) {
      throw this.app.errors.NO_COLL_NAME;
    }
  }
  /**
   * Adds any defined routes
   * @return {Promise}
   */
  async addRoutes() {
    if(!this.router) {
      const server = await this.app.waitForModule('server');
      /** @ignore */ this.router = server.api.createChildRouter(this.root);
    }
    const uniqueRoutes = {};
    this.routes.forEach(r => {
      if(uniqueRoutes[r.route]) {
        return this.log('warn', `duplicate route defined for path '${r.route}', first definition will be used`);
      }
      uniqueRoutes[r.route] = r;
    });
    this.router.addHandlerMiddleware(
      this.processRequestMiddleware.bind(this),
      this.sanitiseRequestDataMiddleware.bind(this),
    );
    const auth = await this.app.waitForModule('auth');
    Object.values(uniqueRoutes).forEach(r => this.addRoute(r, auth));
  }
  /**
   * Adds a single route definition
   * @param {Route} config The route config
   * @param {AuthModule} auth Reference to the AuthModule instance to save await-ing
   */
  addRoute(config, auth) {
    Object.entries(config.handlers).forEach(([method, handler]) => {
      config.handlers[method] = Array.isArray(handler) ? [...handler] : [handler];
      const perms = config.permissions &amp;&amp; config.permissions[method];
      if(perms) { // remove any trailing slashes first
        const route = config.route.endsWith('/') ? config.route.slice(0,-1) : config.route;
        auth.secureRoute(this.router.path + route, method, perms);
      }
    }, {});
    this.router.addRoute(config);
  }
  /**
   * Retrieves a schema by name
   * @param {String} schemaName
   * @return {Object}
   */
  async getSchema(schemaName) {
    return (await this.app.waitForModule('jsonschema')).getSchema(schemaName);
  }
  /**
   * Express request handler for serving the schema
   * @param {external:express~Request} req
   * @param {external:express~Response} res
   * @param {Function} next
   * @return {function}
   */
  async serveSchema(req, res, next) {
    try {
      const schema = await this.getSchema(this.schemaName);
      if(!schema) {
        return next(this.app.errors.NO_SCHEMA_DEF);
      }
      res.type('application/schema+json').json(schema);
    } catch(e) {
      return next(e);
    }
  }
  /**
   * Wrapper for validation, useful for adding custom behaviour pre/post validation in subclasses
   * @param {Object} newData The new data
   * @param {Object} options
   * @return {Promise}
   */
  async handleValidation(newData, options) {
    return options.validate ? this.validate(options.schemaName, newData, options) : newData;
  }
  /**
   * Validates data
   * @param {String} schemaName Name of the schema to validate against
   * @param {Object} data Data to validate
   * @param {Object} options
   */
  async validate(schemaName, data, options) {
    const jsonschema = await this.app.waitForModule('jsonschema');
    const schema = await this.getSchema(schemaName);
    return jsonschema.validate(schema, data, options);
  }
  /**
   * Recursive sanitiser, see sanitiseItem
   * @param {string} schemaName Name of schema to sanitise against
   * @param {object} data Data to sanitise
   * @param {object} options see sanitiseItem
   * @return {Promise} Resolves with the sanitised data
   */
  async sanitise(schemaName, data, options) {
    const isArray = Array.isArray(data);
    const sanitised = await Promise.all((isArray ? data : [data]).map(async d => this.sanitiseItem(await this.getSchema(schemaName), d, options)));
    return isArray ? sanitised : sanitised[0];
  }
  /**
   * Runs a data item through the sanitiser to ensure attributes are removed according to the context
   * @param {string} schemaName Name of schema to sanitise against
   * @param {object} item Data to sanitise
   * @param {object} options
   * @param {Boolean} options.isInternal Whether internal attributes should be filtered
   * @param {Boolean} options.ignoreRequired Whether read-only attributes should be filtered
   * @param {Boolean} options.strict Whether errors should be thrown
   * @return {Promise} Resolves with the sanitised data
   */
  async sanitiseItem(schemaName, item, options) {
    const jsonschema = await this.app.waitForModule('jsonschema');
    return jsonschema.sanitise(await this.getSchema(schemaName), item, options);
  }
  /**
   * Express middleware which correctly formats incoming request data and stores as req.apiData to be used by later handlers. See ApiRequestData typedef for full details.
   * @param {external:express~Request} req
   * @param {external:express~Response} res
   * @param {Function} next
   * @return {Function} Middleware function
   */
  async processRequestMiddleware(req, res, next) {
    const config = req.routeConfig;
    const collectionName = config.collectionName || this.collectionName;
    const schemaName = config.schemaName || this.schemaName;
    const modifying = config.modifying || config?.modifiers?.includes(req.method.toLowerCase()) || false;
    req.apiData = {
      collectionName,
      config,
      data: { ...req.body },
      modifying,
      query: { ...req.query, ...req.params },
      schemaName
    };
    next();
  }
  /**
   * Sanitises incoming request data
   * @param {external:express~Request} req
   * @param {external:express~Response} res
   * @param {Function} next
   * @return {Function} Middleware function
   */
  async sanitiseRequestDataMiddleware(req, res, next) {
    try {
      if(req.apiData.modifying) {
        req.apiData.data = await this.sanitise(req.apiData.schemaName, req.apiData.data, { isReadOnly: true });
      }
    } catch(e) {
      return next(e);
    }
    next();
  }
  /**
   * Middleware to handle a generic API request. Supports POST, GET, PUT and DELETE of items in the database.
   * @return {Function} Express middleware function
   */
  requestHandler() {
    return async (req, res, next) => {
      const method = req.method.toLowerCase();
      const func = this[ApiUtils.httpMethodToDBFunction(method)];
      if(!func) {
        return next(this.app.errors.HTTP_METHOD_NOT_SUPPORTED.setData({ method }));
      }
      let data;
      try {
        await this.requestHook.invoke(req);
        const preCheck = !req.auth.isSuper &amp;&amp; method !== 'get' &amp;&amp; method !== 'post';
        const postCheck = !req.auth.isSuper &amp;&amp; method === 'get';
        if(preCheck) await this.checkAccess(req, req.apiData.query);
        data = await func.apply(this, ApiUtils.argsFromReq(req));
        if(postCheck) data = await this.checkAccess(req, data);
        data = await this.sanitise(req.apiData.schemaName, data, { isInternal: true, strict: false });
      } catch(e) {
        return next(e);
      }
      if(Array.isArray(data) &amp;&amp; req.params._id) { // special case for when _id param is present
        if(!data.length) {
          return next(this.app.errors.NOT_FOUND.setData({ id: req.params.id, type: req.apiData.schemaName }));
        }
        data = data[0];
      }
      if(method !== 'get') {
        const resource = Array.isArray(data) ? req.apiData.query : data._id.toString();
        this.log('debug', `API_${func.name.toUpperCase()}`, resource, 'by', req.auth.user._id.toString());
      }
      res.status(this.mapStatusCode(method)).json(data);
    };
  }
  /**
   * Express request handler for advanced API queries. Supports collation/limit/page/skip/sort and pagination. For incoming query data to be correctly parsed, it must be sent as body data using a POST request.
   * @return {function}
   */
  queryHandler() {
    return async (req, res, next) => {
      try {
        const mongoOpts = {}; // find and remove mongo options from the query
        ['collation', 'limit', 'page', 'skip', 'sort'].forEach(key => {
          if(req.apiData.query[key] === undefined) return;
          try {
            mongoOpts[key] = JSON.parse(req.apiData.query[key]);
          } catch(e) {
            this.log('warn', `failed to parse query ${key} param '${mongoOpts[key]}', ${e}`);
          }
          delete req.apiData.query[key];
        });
        req.apiData.query = await this.parseQuery(req.apiData.schemaName, req.body, mongoOpts);

        await this.setUpPagination(req, res, mongoOpts);

        let results = await this.find(req.apiData.query, {
          schemaName: req.apiData.schemaName,
          collectionName: req.apiData.collectionName
        }, mongoOpts);

        results = await this.checkAccess(req, results);
        results = await this.sanitise(req.apiData.schemaName, results, { isInternal: true, strict: false });
        
        res.status(this.mapStatusCode('get')).json(results);

      } catch(e) {
        return next(e);
      }
    };
  }
  /**
   * Parses an incoming query for use in the DB module
   * @param {String} schemaName The schema name for the data being queried
   * @param {Object} query The query data
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @returns {Object} The parsed query
   */
  async parseQuery(schemaName, query = {}, mongoOptions) {
    if(schemaName) {
      try {
        const opts = { ignoreRequired: true, useDefaults: false, ...mongoOptions };
        if(query.$or) {
          query.$or.map(async expr => {
            try {
              return await this.validate(schemaName, expr, opts);
            } catch(e) { // just return the original expression on error
              return expr;
            }
          });
        } else {
          Object.assign({}, query, await this.validate(schemaName, query, opts));
        }
      } catch(e) {}
    }
    return Object.assign({}, query);
  }
  /**
   * Validates and sets the relevant pagination options (limit, skip) and HTTP headers (X-Adapt-Page, X-Adapt-PageTotal, Link). 
   * @param {external:express~Request} req 
   * @param {external:express~Response} res 
   * @param {Object} mongoOpts The MongoDB options
   */
  async setUpPagination(req, res, mongoOpts) {
    const maxPageSize = this.app.config.get('adapt-authoring-api.maxPageSize');
    let pageSize = mongoOpts.limit ?? this.app.config.get('adapt-authoring-api.defaultPageSize');

    if(pageSize > maxPageSize) pageSize = maxPageSize;

    const mongodb = await this.app.waitForModule('mongodb');
    const docCount = await mongodb.getCollection(req.apiData.collectionName).countDocuments(req.apiData.query);
    const pageTotal = Math.ceil(docCount/pageSize) || 1;
    let page = parseInt(mongoOpts.page);

    if(isNaN(page) || page &lt; 1) page = 1; // normalise invalid values
    if(page > pageTotal) page = pageTotal;

    res.set('X-Adapt-Page', page);
    res.set('X-Adapt-PageSize', pageSize);
    res.set('X-Adapt-PageTotal', pageTotal);

    if(pageTotal > 1) {
      // absolute URL with paging params removed
      const baseUrl = `${req.originalUrl.split('?')[0]}?` + Object.entries(req.query)
        .filter(([k]) => k !== 'page' &amp;&amp; k !== 'limit')
        .map(([k,v]) => `${k}=${v}`)
        .join('&amp;');
      const prevPage = page-1;
      const nextPage = page+1;
      const l = (page, rel) => `&lt;${baseUrl}&amp;per_page=${pageSize}&amp;page=${page}>; rel="${rel}"`;
      const links = [
        page > 1 &amp;&amp; l(1, 'first'),
        prevPage > 0 &amp;&amp; l(prevPage, 'prev'),
        nextPage &lt;= pageTotal &amp;&amp; l(nextPage, 'next'),
        page &lt; pageTotal &amp;&amp; l(pageTotal, 'last'),
      ].filter(Boolean).join(', ');

      res.set('Link', links);
    }
    // add pagination attributes to mongodb options
    Object.assign(mongoOpts, { limit: pageSize, skip: mongoOpts.skip || (page-1)*pageSize });
  }
  /**
   * Invokes the access check hook to allow modules to determine whether the request user has sufficient access to the requested resource(s)
   * @param {external:express~Request} req
   * @param {Object} data The data to be checked
   * @return {Promise} Rejects if access should be blocked
   */
  async checkAccess(req, data) {
    const isArray = Array.isArray(data);
    const filtered = [];
    let error;
    await Promise.allSettled((isArray ? data : [data]).map(async r => {
      try {
        if(!this.accessCheckHook.hasObservers || req.auth.isSuper ||
          (await this.accessCheckHook.invoke(req, r)).some(Boolean)) {
          filtered.push(r);
        }
      } catch(e) {
        error = this.app.errors.UNAUTHORISED
          .setData({ method: req.method, url: req.url });
      }
    }));
    if(isArray) return filtered; // we can ignore errors for arrays
    if(error) throw error;
    return filtered[0];
  }
  /**
   * Inserts a new document into the DB
   * @param {Object} data Data to be inserted into the DB
   * @param {Object} options Function options
   * @param {String} options.schemaName Name of the schema to validate against
   * @param {String} options.collectionName DB collection to insert document into
   * @param {String} options.validate Whether the incoming data should be validated
   * @param {String} options.invokePostHook Whether the function should invoke the 'post' action hook on success
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @emits {insert} Emitted on a successful insert. The inserted data is passed to the callback as a parameter
   * @return {Promise} Resolves with DB data
   */
  async insert(data, options={}, mongoOptions={}) {
    this.setDefaultOptions(options);
    await this.preInsertHook.invoke(data, options, mongoOptions);
    data = await this.handleValidation(data, options);
    const mongodb = await this.app.waitForModule('mongodb');
    const results = await mongodb.insert(options.collectionName, data, mongoOptions);
    if(options.invokePostHook) this.postInsertHook.invoke(results);
    return results;
  }
  /**
   * Retrieves documents from the DB
   * @param {Object} query Attributes to use to filter DB documents
   * @param {Object} options Function options
   * @param {String} options.schemaName Name of the schema to validate against
   * @param {String} options.collectionName DB collection to insert document into
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @return {Promise} Resolves with DB data
   */
  async find(query, options={}, mongoOptions={}) {
    this.setDefaultOptions(options);
    const q = await this.parseQuery(options.schemaName, query, options, mongoOptions);
    return this.cache.get(q, options, mongoOptions);
  }
  /**
   * Updates an existing document in the DB
   * @param {Object} query Attributes to use to filter DB documents
   * @param {Object} data Data to be inserted into the DB
   * @param {Object} options Function options
   * @param {String} options.schemaName Name of the schema to validate against
   * @param {String} options.collectionName DB collection to insert document into
   * @param {Boolean} options.validate Whether the incoming data should be validated
   * @param {String} options.invokePostHook Whether the function should invoke the 'post' action hook on success
   * @param {Boolean} options.rawUpdate Whether the provided data should be considered 'raw' (i.e. not format and apply $set MongoDB keyword)
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @emits {update} Emitted on a successful update. The original and updated data are passed to the callback as separate parameters
   * @return {Promise} Resolves with DB data
   */
  async update(query, data, options={}, mongoOptions={}) {
    this.setDefaultOptions(options);
    
    const mongodb = await this.app.waitForModule('mongodb');
    const [originalDoc] = await mongodb.find(options.collectionName, query);
    
    if(!originalDoc) {
      throw this.app.errors.NOT_FOUND.setData({ id: query._id ?? query.toString(), type: options.schemaName });
    }
    const formattedData = options.rawUpdate ? { $set: {}, ...data } : { $set: data };
    const opts = { ignoreRequired: true, useDefaults: false, ...options };
    
    await this.preUpdateHook.invoke(originalDoc, formattedData.$set, opts, mongoOptions);
    formattedData.$set = await this.handleValidation({ ...JSON.parse(JSON.stringify(originalDoc)), ...formattedData.$set }, opts);

    const results = await mongodb.update(options.collectionName, query, formattedData, mongoOptions);
    if(options.invokePostHook) this.postUpdateHook.invoke(originalDoc, results);
    return results;
  }
  /**
   * Removes a single document from the DB
   * @param {Object} query Attributes to use to filter DB documents
   * @param {Object} options Function options
   * @param {String} options.collectionName DB collection to remove document from
   * @param {String} options.invokePostHook Whether the function should invoke the 'post' action hook on success
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @emits {delete} Emitted on a successful delete. The deleted data is passed to the callback as a parameter
   * @return {Promise} Resolves with DB data
   */
  async delete(query, options={}, mongoOptions={}) {
    this.setDefaultOptions(options);

    const mongodb = await this.app.waitForModule('mongodb');
    const [originalDoc] = await mongodb.find(options.collectionName, query);

    if(!originalDoc) {
      throw this.app.errors.NOT_FOUND.setData({ id: query._id ?? query.toString(), type: options.schemaName });
    }
    await this.preDeleteHook.invoke(originalDoc, options, mongoOptions);
    await mongodb.delete(options.collectionName, query, mongoOptions);
    if(options.invokePostHook) this.postDeleteHook.invoke(originalDoc);
    return originalDoc;
  }
  /**
   * Removes multiple documents from the DB
   * @param {Object} query Attributes to use to filter DB documents
   * @param {Object} options Function options
   * @param {String} options.collectionName DB collection to remove document from
   * @param {String} options.invokePostHook Whether the function should invoke the 'post' action hook on success
   * @param {Object} mongoOptions Options to be passed to the MongoDB function
   * @emits {delete} Emitted on a successful delete.
   * @return {Promise}
   */
  async deleteMany(query, options={}, mongoOptions={}) {
    this.setDefaultOptions(options);

    const mongodb = await this.app.waitForModule('mongodb');
    const toDelete = await mongodb.find(options.collectionName, query);

    await mongodb.deleteMany(options.collectionName, query, mongoOptions);
    if(options.invokePostHook) toDelete.forEach(d => this.postDeleteHook.invoke(d));
  }
}

export default AbstractApiModule;</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.11</a> on Tue Jan 17 2023 13:59:43 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>


<script src="scripts/collapse.js" defer></script>


    <link type="text/css" rel="stylesheet" href="styles/adapt.css">
    
    <script src="scripts/adapt.js"></script>
    
</body>
</html>
